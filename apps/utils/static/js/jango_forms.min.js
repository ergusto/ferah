(function(e,c,b,g){var d="jangoForm",f={redirect:false,redirectURL:"",handlebarsTemplate:null,preppendTo:null,appendTo:null,formErrorElement:e("#form_errors"),formErrorClass:"form-error",fieldErrorClass:"error",resetOnSuccess:true};function a(i,h){this.form=e(i);this.settings=h;this._defaults=f;this._name=d;this.init()}a.prototype={init:function(){this.primeEventListeners()},applyFormError:function(j,h){var k=this.settings.formErrorElement,i=e("<span />").addClass(this.settings.formErrorClass).text(h[0]);k.css("display","block");k.append(i)},applyFieldError:function(i,j){var h=e("#id_"+i),k=e("<span />").addClass(this.settings.fieldErrorClass).text(j[0]);k.insertAfter(h)},clearFormErrors:function(h){var i=this.settings.formErrorElement;i.empty();e(".error",h).remove()},initiateRedirect:function(h){if(this.settings.redirectURL){c.location.replace(this.settings.redirectURL)}else{if(h.redirect_url){c.location.replace(h.redirect_url)}else{if(h.get_absolute_url){c.location.replace(h.get_absolute_url)}else{console.log("No url to redirect to. Please provide one in the constructor.");return}}}},renderHandlebars:function(h){var k=h;var m=this.settings.handlebarsTemplate.html();var l=Handlebars.compile(m);if(this.settings.preppendTo&&this.settings.appendTo){console.log("Please supply an element to either prependTo, or appendTo, but not both.");return}else{if(this.settings.preppendTo){var j=this.settings.preppendTo;j.prepend(l(k))}else{if(this.settings.appendTo){var i=this.settings.appendTo;i.append(l(k))}}}},parseAjaxSuccessResponse:function(h){if(this.settings.redirect){this.initiateRedirect(h)}else{if(this.settings.handlebarsTemplate){this.renderHandlebars(h)}else{console.log("Please either provide a redirectURL and set redirect to true, or provide a handlebars template in the constructor.");return}}},parseAjaxErrorResponse:function(i){var h=this;var j=e.parseJSON(i.responseText);e.each(j,function(k,l){if(k==="__all__"){h.applyFormError(h.form,l)}else{h.applyFieldError(k,l)}})},sendAjaxRequest:function(i){var h=this;$form=e(i);this.clearFormErrors($form);e.ajax({type:$form.attr("method"),url:$form.attr("action"),contentType:"application/x-www-form-urlencoded;charset=utf-8",data:$form.serialize(),success:function(j){h.parseAjaxSuccessResponse(j);if(!h.settings.redirect&&h.settings.resetOnSuccess){h.form.trigger("reset")}},error:function(j,l,k){h.parseAjaxErrorResponse(j)}})},primeEventListeners:function(){var h=this;this.form.submit(function(i){i.preventDefault();h.sendAjaxRequest(this)})}};e.fn[d]=function(h){return this.each(function(){var i=e.extend({},f,h);if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new a(this,i))}},h)}})(jQuery,window,document);